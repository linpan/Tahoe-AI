<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VLLM å¹¶è¡Œç­–ç•¥å›¾è§£</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .parallel-section {
            margin: 40px 0;
            padding: 20px;
            border-radius: 15px;
            background: #f8f9fa;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .section-title {
            font-size: 1.8em;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }

        .gpu-grid {
            display: grid;
            gap: 15px;
            margin: 20px 0;
            justify-content: center;
        }

        .tensor-parallel-grid {
            grid-template-columns: repeat(4, 1fr);
            max-width: 800px;
        }

        .pipeline-parallel-grid {
            grid-template-columns: repeat(2, 1fr);
            max-width: 400px;
        }

        .gpu-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);
            transition: transform 0.3s ease;
        }

        .gpu-card:hover {
            transform: translateY(-5px);
        }

        .layer-card {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(250, 112, 154, 0.3);
            transition: transform 0.3s ease;
        }

        .layer-card:hover {
            transform: translateY(-5px);
        }

        .arrow {
            text-align: center;
            font-size: 2em;
            color: #667eea;
            margin: 20px 0;
        }

        .description {
            background: #e8f4f8;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #667eea;
        }

        .combined-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 40px 0;
        }

        .combined-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .stage {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .stage h4 {
            margin: 0 0 10px 0;
            font-size: 1.1em;
        }

        .mini-gpu {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            padding: 5px;
            margin: 3px;
            font-size: 0.8em;
            display: inline-block;
            min-width: 40px;
        }

        .flow-arrow {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            color: #ffffff;
        }

        .summary {
            background: #f1f8ff;
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
            border: 2px solid #667eea;
        }

        .summary h3 {
            color: #2c3e50;
            margin-top: 0;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .comparison-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .comparison-table tr:hover {
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>VLLM å¹¶è¡Œç­–ç•¥ï¼šå¼ é‡å¹¶è¡Œ vs æµæ°´çº¿å¹¶è¡Œ</h1>

        <!-- å¼ é‡å¹¶è¡Œéƒ¨åˆ† -->
        <div class="parallel-section">
            <div class="section-title">ğŸ”§ å¼ é‡å¹¶è¡Œ (Tensor Parallel) - TP=8</div>

            <div class="description">
                <strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong>å°†å•ä¸ªç¥ç»ç½‘ç»œå±‚çš„è®¡ç®—åœ¨å¤šä¸ªGPUä¸Šæ°´å¹³åˆ†å‰²ï¼Œæ¯ä¸ªGPUå¤„ç†éƒ¨åˆ†æƒé‡çŸ©é˜µã€‚
            </div>

            <div class="gpu-grid tensor-parallel-grid">
                <div class="gpu-card">GPU 0<br><small>æƒé‡åˆ†ç‰‡ 1/8</small></div>
                <div class="gpu-card">GPU 1<br><small>æƒé‡åˆ†ç‰‡ 2/8</small></div>
                <div class="gpu-card">GPU 2<br><small>æƒé‡åˆ†ç‰‡ 3/8</small></div>
                <div class="gpu-card">GPU 3<br><small>æƒé‡åˆ†ç‰‡ 4/8</small></div>
                <div class="gpu-card">GPU 4<br><small>æƒé‡åˆ†ç‰‡ 5/8</small></div>
                <div class="gpu-card">GPU 5<br><small>æƒé‡åˆ†ç‰‡ 6/8</small></div>
                <div class="gpu-card">GPU 6<br><small>æƒé‡åˆ†ç‰‡ 7/8</small></div>
                <div class="gpu-card">GPU 7<br><small>æƒé‡åˆ†ç‰‡ 8/8</small></div>
            </div>

            <div class="arrow">â¬‡ï¸ åŒä¸€å±‚å¹¶è¡Œè®¡ç®— â¬‡ï¸</div>

            <div style="text-align: center; padding: 20px; background: #e8f4f8; border-radius: 10px;">
                <strong>All-Reduce é€šä¿¡èšåˆç»“æœ</strong>
            </div>
        </div>

        <!-- æµæ°´çº¿å¹¶è¡Œéƒ¨åˆ† -->
        <div class="parallel-section">
            <div class="section-title">ğŸ”„ æµæ°´çº¿å¹¶è¡Œ (Pipeline Parallel) - PP=2 è¯¦è§£</div>

            <div class="description">
                <strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong>å°†ç¥ç»ç½‘ç»œçš„ä¸åŒå±‚åˆ†é…åˆ°ä¸åŒçš„GPUç»„ä¸Šï¼Œå½¢æˆè®¡ç®—æµæ°´çº¿ï¼Œç±»ä¼¼å·¥å‚ç”Ÿäº§çº¿ã€‚
            </div>

            <!-- æ¨¡å‹å±‚åˆ†å‰²ç¤ºæ„ -->
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h4 style="text-align: center; color: #2c3e50;">ğŸ§  ç¥ç»ç½‘ç»œå±‚åˆ†å‰²ç¤ºæ„ï¼ˆä»¥32å±‚Transformerä¸ºä¾‹ï¼‰</h4>
                <div style="display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap;">
                    <div style="background: #4facfe; color: white; padding: 15px; border-radius: 10px; text-align: center; flex: 1; min-width: 200px;">
                        <strong>Stage 0 (GPUç»„0)</strong><br>
                        <div style="font-size: 0.9em; margin-top: 10px;">
                            â€¢ Layer 1-16<br>
                            â€¢ Embeddingå±‚<br>
                            â€¢ å‰16ä¸ªTransformerå—<br>
                            â€¢ Self-Attention + FFN
                        </div>
                    </div>
                    <div style="font-size: 2em; color: #667eea;">â¡ï¸</div>
                    <div style="background: #fa709a; color: white; padding: 15px; border-radius: 10px; text-align: center; flex: 1; min-width: 200px;">
                        <strong>Stage 1 (GPUç»„1)</strong><br>
                        <div style="font-size: 0.9em; margin-top: 10px;">
                            â€¢ Layer 17-32<br>
                            â€¢ å16ä¸ªTransformerå—<br>
                            â€¢ LayerNorm<br>
                            â€¢ LM Headè¾“å‡ºå±‚
                        </div>
                    </div>
                </div>
            </div>

            <!-- æµæ°´çº¿æ—¶åºå›¾ -->
            <div style="background: #e8f4f8; padding: 25px; border-radius: 15px; margin: 20px 0;">
                <h4 style="text-align: center; color: #2c3e50;">â±ï¸ æµæ°´çº¿æ—¶åºæ‰§è¡Œå›¾</h4>
                <div style="font-family: monospace; background: white; padding: 20px; border-radius: 10px; overflow-x: auto;">
                    <div style="display: grid; grid-template-columns: 80px repeat(8, 1fr); gap: 5px; align-items: center;">
                        <!-- è¡¨å¤´ -->
                        <div style="font-weight: bold;">æ—¶é—´æ­¥</div>
                        <div style="text-align: center; font-weight: bold;">T1</div>
                        <div style="text-align: center; font-weight: bold;">T2</div>
                        <div style="text-align: center; font-weight: bold;">T3</div>
                        <div style="text-align: center; font-weight: bold;">T4</div>
                        <div style="text-align: center; font-weight: bold;">T5</div>
                        <div style="text-align: center; font-weight: bold;">T6</div>
                        <div style="text-align: center; font-weight: bold;">T7</div>
                        <div style="text-align: center; font-weight: bold;">T8</div>

                        <!-- Stage 0 -->
                        <div style="font-weight: bold; color: #4facfe;">Stage 0</div>
                        <div style="background: #4facfe; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch1</div>
                        <div style="background: #4facfe; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch2</div>
                        <div style="background: #4facfe; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch3</div>
                        <div style="background: #4facfe; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch4</div>
                        <div style="background: #4facfe; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch5</div>
                        <div style="background: #4facfe; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch6</div>
                        <div style="background: #4facfe; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch7</div>
                        <div style="background: #4facfe; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch8</div>

                        <!-- Stage 1 -->
                        <div style="font-weight: bold; color: #fa709a;">Stage 1</div>
                        <div style="background: #f0f0f0; text-align: center; padding: 8px; border-radius: 5px; color: #999;">ç­‰å¾…</div>
                        <div style="background: #fa709a; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch1</div>
                        <div style="background: #fa709a; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch2</div>
                        <div style="background: #fa709a; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch3</div>
                        <div style="background: #fa709a; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch4</div>
                        <div style="background: #fa709a; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch5</div>
                        <div style="background: #fa709a; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch6</div>
                        <div style="background: #fa709a; color: white; text-align: center; padding: 8px; border-radius: 5px;">Batch7</div>
                    </div>
                </div>
                <div style="margin-top: 15px; font-size: 0.9em; color: #666;">
                    <strong>è¯´æ˜ï¼š</strong>Stage 0å¤„ç†å®ŒBatch1åï¼Œç«‹å³ä¼ é€’ç»™Stage 1ï¼ŒåŒæ—¶å¼€å§‹å¤„ç†Batch2ï¼Œå®ç°æµæ°´çº¿å¹¶è¡Œã€‚
                </div>
            </div>

            <!-- è¯¦ç»†å·¥ä½œæµç¨‹ -->
            <div style="background: #fff3cd; padding: 20px; border-radius: 15px; margin: 20px 0;">
                <h4 style="color: #856404; margin-top: 0;">ğŸ”„ è¯¦ç»†å·¥ä½œæµç¨‹</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                    <div style="background: white; padding: 15px; border-radius: 10px; border-left: 4px solid #4facfe;">
                        <strong>æ­¥éª¤1ï¼šåˆå§‹åŒ–</strong><br>
                        â€¢ Stage 0 åŠ è½½ Layer 1-16<br>
                        â€¢ Stage 1 åŠ è½½ Layer 17-32<br>
                        â€¢ æ¯ä¸ªStageå ç”¨ä¸åŒGPU
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 10px; border-left: 4px solid #fa709a;">
                        <strong>æ­¥éª¤2ï¼šå¼€å§‹è®¡ç®—</strong><br>
                        â€¢ è¾“å…¥è¿›å…¥Stage 0<br>
                        â€¢ Stage 0å¤„ç†å‰16å±‚<br>
                        â€¢ Stage 1ç­‰å¾…ä¸­é—´ç»“æœ
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 10px; border-left: 4px solid #28a745;">
                        <strong>æ­¥éª¤3ï¼šä¼ é€’æ¿€æ´»</strong><br>
                        â€¢ Stage 0è®¡ç®—å®Œæˆ<br>
                        â€¢ æ¿€æ´»å€¼ä¼ é€’ç»™Stage 1<br>
                        â€¢ Stage 0å¼€å§‹ä¸‹ä¸€æ‰¹æ•°æ®
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 10px; border-left: 4px solid #17a2b8;">
                        <strong>æ­¥éª¤4ï¼šå¹¶è¡Œå¤„ç†</strong><br>
                        â€¢ Stage 1å¤„ç†å16å±‚<br>
                        â€¢ Stage 0åŒæ—¶å¤„ç†æ–°æ‰¹æ¬¡<br>
                        â€¢ å®ç°çœŸæ­£çš„æµæ°´çº¿
                    </div>
                </div>
            </div>

            <!-- å†…å­˜å’Œé€šä¿¡åˆ†æ -->
            <div style="background: #f1f8ff; padding: 20px; border-radius: 15px; margin: 20px 0; border: 2px solid #667eea;">
                <h4 style="color: #2c3e50; margin-top: 0;">ğŸ’¾ å†…å­˜å’Œé€šä¿¡åˆ†æ</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h5 style="color: #4facfe;">ğŸ“Š å†…å­˜åˆ†å¸ƒ</h5>
                        <ul style="line-height: 1.6;">
                            <li><strong>Stage 0ï¼š</strong>åªéœ€å­˜å‚¨å‰16å±‚å‚æ•°</li>
                            <li><strong>Stage 1ï¼š</strong>åªéœ€å­˜å‚¨å16å±‚å‚æ•°</li>
                            <li><strong>ä¼˜åŠ¿ï¼š</strong>å†…å­˜éœ€æ±‚å‡åŠ</li>
                            <li><strong>æ¿€æ´»å€¼ï¼š</strong>éœ€è¦å­˜å‚¨ä¸­é—´æ¿€æ´»å€¼</li>
                        </ul>
                    </div>
                    <div>
                        <h5 style="color: #fa709a;">ğŸŒ é€šä¿¡å¼€é”€</h5>
                        <ul style="line-height: 1.6;">
                            <li><strong>å‰å‘ä¼ æ’­ï¼š</strong>Stageé—´ä¼ é€’æ¿€æ´»å€¼</li>
                            <li><strong>åå‘ä¼ æ’­ï¼š</strong>Stageé—´ä¼ é€’æ¢¯åº¦</li>
                            <li><strong>é€šä¿¡é‡ï¼š</strong>ç›¸å¯¹è¾ƒå°ï¼ˆåªæœ‰æ¿€æ´»å€¼ï¼‰</li>
                            <li><strong>å»¶è¿Ÿï¼š</strong>å­˜åœ¨Pipeline bubble</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Pipeline Bubble é—®é¢˜ -->
            <div style="background: #ffe6e6; padding: 20px; border-radius: 15px; margin: 20px 0; border-left: 4px solid #dc3545;">
                <h4 style="color: #721c24; margin-top: 0;">âš ï¸ Pipeline Bubble é—®é¢˜</h4>
                <div style="background: white; padding: 15px; border-radius: 10px; font-family: monospace; overflow-x: auto;">
                    <div style="margin-bottom: 10px;"><strong>ç†æƒ³æƒ…å†µ vs å®é™…æƒ…å†µï¼š</strong></div>
                    <div style="color: #28a745;">âœ… ç†æƒ³ï¼šStage 0 â†’ Stage 1 â†’ Stage 0 â†’ Stage 1 ...</div>
                    <div style="color: #dc3545;">âŒ å®é™…ï¼šStage 0 â†’ ç­‰å¾… â†’ Stage 1 â†’ ç­‰å¾… â†’ Stage 0 ...</div>
                </div>
                <p style="margin-top: 15px; font-size: 0.95em;">
                    <strong>è§£å†³æ–¹æ¡ˆï¼š</strong>
                    â€¢ ä½¿ç”¨Micro-batchingæŠ€æœ¯<br>
                    â€¢ å¢åŠ Pipelineæ·±åº¦<br>
                    â€¢ ä¼˜åŒ–æ‰¹æ¬¡å¤§å°
                </p>
            </div>
        </div>

        <!-- ç»„åˆç­–ç•¥éƒ¨åˆ† -->
        <div class="combined-section">
            <div class="section-title" style="color: white;">ğŸš€ ç»„åˆç­–ç•¥ï¼šTP=8 + PP=2 (æ€»å…±16ä¸ªGPU)</div>

            <div class="combined-grid">
                <div class="stage">
                    <h4>Pipeline Stage 0</h4>
                    <div class="mini-gpu">GPU 0</div>
                    <div class="mini-gpu">GPU 1</div>
                    <div class="mini-gpu">GPU 2</div>
                    <div class="mini-gpu">GPU 3</div>
                    <div class="mini-gpu">GPU 4</div>
                    <div class="mini-gpu">GPU 5</div>
                    <div class="mini-gpu">GPU 6</div>
                    <div class="mini-gpu">GPU 7</div>
                    <div style="font-size: 0.9em; margin-top: 10px;">å‰åŠéƒ¨åˆ†å±‚<br>8è·¯å¼ é‡å¹¶è¡Œ</div>
                </div>

                <div class="flow-arrow">â¡ï¸</div>

                <div class="stage">
                    <h4>Pipeline Stage 1</h4>
                    <div class="mini-gpu">GPU 8</div>
                    <div class="mini-gpu">GPU 9</div>
                    <div class="mini-gpu">GPU 10</div>
                    <div class="mini-gpu">GPU 11</div>
                    <div class="mini-gpu">GPU 12</div>
                    <div class="mini-gpu">GPU 13</div>
                    <div class="mini-gpu">GPU 14</div>
                    <div class="mini-gpu">GPU 15</div>
                    <div style="font-size: 0.9em; margin-top: 10px;">ååŠéƒ¨åˆ†å±‚<br>8è·¯å¼ é‡å¹¶è¡Œ</div>
                </div>

                <div class="flow-arrow">ğŸ“¤</div>
            </div>

            <div style="text-align: center; margin-top: 20px; font-size: 1.1em;">
                <strong>æ•°æ®æµï¼šè¾“å…¥ â†’ Stage 0 (8ä¸ªGPUå¹¶è¡Œ) â†’ Stage 1 (8ä¸ªGPUå¹¶è¡Œ) â†’ è¾“å‡º</strong>
            </div>
        </div>

        <!-- æµæ°´çº¿å¹¶è¡Œå…·ä½“ä¾‹å­ -->
        <div style="background: #f8f9fa; padding: 30px; border-radius: 15px; margin: 40px 0;">
            <h3 style="text-align: center; color: #2c3e50; margin-bottom: 30px;">ğŸ¯ æµæ°´çº¿å¹¶è¡Œå…·ä½“ä¾‹å­ï¼šGPTæ¨¡å‹æ¨ç†</h3>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                    <h4 style="color: #4facfe; margin-top: 0;">ğŸ”µ ä¼ ç»Ÿå•GPUæ–¹å¼</h4>
                    <div style="font-family: monospace; background: #f8f9fa; padding: 15px; border-radius: 5px;">
<pre style="margin: 0; font-size: 0.9em;">GPU 0 å¤„ç†å…¨éƒ¨32å±‚ï¼š
Time 1: [Input] â†’ L1â†’L2â†’...â†’L32 â†’ [Output1]
Time 2: [Input] â†’ L1â†’L2â†’...â†’L32 â†’ [Output2]
Time 3: [Input] â†’ L1â†’L2â†’...â†’L32 â†’ [Output3]

æ€»æ—¶é—´ = 3 Ã— 32å±‚è®¡ç®—æ—¶é—´
GPUåˆ©ç”¨ç‡ = 100%ï¼ˆä½†ä¸²è¡Œï¼‰</pre>
                    </div>
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                    <h4 style="color: #fa709a; margin-top: 0;">ğŸ”´ æµæ°´çº¿å¹¶è¡Œæ–¹å¼ (PP=2)</h4>
                    <div style="font-family: monospace; background: #f8f9fa; padding: 15px; border-radius: 5px;">
<pre style="margin: 0; font-size: 0.9em;">GPU 0: L1-L16    GPU 1: L17-L32
Time 1: [Input1]â†’L1-L16 |  ç­‰å¾…
Time 2: [Input2]â†’L1-L16 | [ä»GPU0]â†’L17-L32â†’[Out1]
Time 3: [Input3]â†’L1-L16 | [ä»GPU0]â†’L17-L32â†’[Out2]

æ€»æ—¶é—´ â‰ˆ (åˆå§‹å»¶è¿Ÿ) + N Ã— 16å±‚è®¡ç®—æ—¶é—´
ä¸¤ä¸ªGPUåŒæ—¶å·¥ä½œï¼</pre>
                    </div>
                </div>
            </div>

            <!-- è¯¦ç»†çš„æ•°æ®æµåŠ¨å›¾ -->
            <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                <h4 style="text-align: center; color: #2c3e50;">ğŸ“Š æ•°æ®æµåŠ¨è¯¦ç»†è¿‡ç¨‹</h4>

                <div style="display: flex; justify-content: space-between; align-items: center; margin: 20px 0;">
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 10px; text-align: center; min-width: 120px;">
                        <strong>è¾“å…¥æ•°æ®</strong><br>
                        <small>Tokenåºåˆ—<br>[Hello, World, !]</small>
                    </div>
                    <div style="font-size: 1.5em; color: #2196f3;">â¡ï¸</div>
                    <div style="background: #4facfe; color: white; padding: 15px; border-radius: 10px; text-align: center; min-width: 150px;">
                        <strong>Stage 0</strong><br>
                        <small>GPU 0-7<br>Embedding + L1-L16</small>
                    </div>
                    <div style="font-size: 1.5em; color: #2196f3;">â¡ï¸</div>
                    <div style="background: #fa709a; color: white; padding: 15px; border-radius: 10px; text-align: center; min-width: 150px;">
                        <strong>Stage 1</strong><br>
                        <small>GPU 8-15<br>L17-L32 + LM Head</small>
                    </div>
                    <div style="font-size: 1.5em; color: #2196f3;">â¡ï¸</div>
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 10px; text-align: center; min-width: 120px;">
                        <strong>è¾“å‡ºç»“æœ</strong><br>
                        <small>ä¸‹ä¸€ä¸ªToken<br>æ¦‚ç‡åˆ†å¸ƒ</small>
                    </div>
                </div>

                <div style="background: #f0f8ff; padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h5 style="color: #2c3e50; margin-top: 0;">ğŸ” ä¸­é—´æ¿€æ´»å€¼ä¼ é€’ç»†èŠ‚</h5>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #4facfe;">
                            <strong>å½¢çŠ¶å˜åŒ–ï¼š</strong><br>
                            â€¢ è¾“å…¥: [batch_size, seq_len, hidden_size]<br>
                            â€¢ Stage 0è¾“å‡º: [batch_size, seq_len, hidden_size]<br>
                            â€¢ Stage 1è¾“å‡º: [batch_size, seq_len, vocab_size]
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #fa709a;">
                            <strong>å†…å­˜å ç”¨ï¼š</strong><br>
                            â€¢ æ¿€æ´»å€¼å¤§å° â‰ˆ å‡ ç™¾MBåˆ°å‡ GB<br>
                            â€¢ éœ€è¦ç¼“å­˜ä¸­é—´ç»“æœ<br>
                            â€¢ æ¯”æ¨¡å‹å‚æ•°å°å¾ˆå¤š
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;">
                            <strong>ä¼ è¾“æ—¶é—´ï¼š</strong><br>
                            â€¢ é€šå¸¸ < 1ms (GPUé—´é«˜é€Ÿè¿æ¥)<br>
                            â€¢ ç›¸æ¯”è®¡ç®—æ—¶é—´å¯å¿½ç•¥<br>
                            â€¢ å¼‚æ­¥ä¼ è¾“ä¼˜åŒ–
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ€§èƒ½å¯¹æ¯” -->
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 15px; margin: 30px 0;">
                <h4 style="margin-top: 0; text-align: center;">âš¡ æ€§èƒ½æå‡åˆ†æ</h4>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px;">
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; backdrop-filter: blur(10px);">
                        <h5>ğŸš€ ååé‡æå‡</h5>
                        <ul style="line-height: 1.8;">
                            <li><strong>ç†è®ºåŠ é€Ÿæ¯”ï¼š</strong> ~2å€ (PP=2)</li>
                            <li><strong>å®é™…åŠ é€Ÿæ¯”ï¼š</strong> ~1.7å€ (è€ƒè™‘bubble)</li>
                            <li><strong>æ‰¹å¤„ç†æ•ˆæœï¼š</strong> æ‰¹æ¬¡è¶Šå¤§æ•ˆæœè¶Šå¥½</li>
                            <li><strong>å»¶è¿Ÿå½±å“ï¼š</strong> é¦–æ‰¹å»¶è¿Ÿç¨é«˜</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; backdrop-filter: blur(10px);">
                        <h5>ğŸ’¾ å†…å­˜ä¼˜åŒ–</h5>
                        <ul style="line-height: 1.8;">
                            <li><strong>å‚æ•°å†…å­˜ï¼š</strong> å‡å°‘50% (æ¯ä¸ªstage)</li>
                            <li><strong>æ¿€æ´»å†…å­˜ï¼š</strong> éœ€è¦é¢å¤–å­˜å‚¨ä¸­é—´ç»“æœ</li>
                            <li><strong>æ€»ä½“æ•ˆæœï¼š</strong> æ”¯æŒæ›´å¤§æ¨¡å‹</li>
                            <li><strong>å†…å­˜å‡è¡¡ï¼š</strong> å„GPUè´Ÿè½½å¹³è¡¡</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- å¯¹æ¯”è¡¨æ ¼ -->
        <div class="summary">
            <h3>ğŸ“Š ç­–ç•¥å¯¹æ¯”åˆ†æ</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>ç‰¹æ€§</th>
                        <th>å¼ é‡å¹¶è¡Œ (TP=8)</th>
                        <th>æµæ°´çº¿å¹¶è¡Œ (PP=2)</th>
                        <th>ç»„åˆç­–ç•¥ (TP=8, PP=2)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>GPUæ•°é‡</strong></td>
                        <td>8ä¸ªGPU</td>
                        <td>2ä¸ªGPUç»„</td>
                        <td>16ä¸ªGPU</td>
                    </tr>
                    <tr>
                        <td><strong>å†…å­˜åˆ†å¸ƒ</strong></td>
                        <td>æ¨¡å‹æƒé‡åˆ†ç‰‡åˆ°8ä¸ªGPU</td>
                        <td>ä¸åŒå±‚åˆ†å¸ƒåˆ°ä¸åŒç»„</td>
                        <td>æƒé‡åˆ†ç‰‡+å±‚åˆ†å‰²</td>
                    </tr>
                    <tr>
                        <td><strong>é€šä¿¡å¼€é”€</strong></td>
                        <td>é¢‘ç¹çš„All-Reduceé€šä¿¡</td>
                        <td>è¾ƒå°‘çš„ç‚¹å¯¹ç‚¹é€šä¿¡</td>
                        <td>ç»„å†…All-Reduce + ç»„é—´P2P</td>
                    </tr>
                    <tr>
                        <td><strong>å¹¶è¡Œæ•ˆç‡</strong></td>
                        <td>åŒæ­¥è®¡ç®—ï¼Œæ— æµæ°´çº¿</td>
                        <td>å¼‚æ­¥æµæ°´çº¿ï¼Œåˆ©ç”¨ç‡é«˜</td>
                        <td>ç»“åˆä¸¤è€…ä¼˜åŠ¿</td>
                    </tr>
                    <tr>
                        <td><strong>é€‚ç”¨åœºæ™¯</strong></td>
                        <td>å•å±‚è®¡ç®—å¯†é›†å‹</td>
                        <td>æ·±å±‚ç½‘ç»œï¼Œå†…å­˜å—é™</td>
                        <td>å¤§è§„æ¨¡æ¨¡å‹æ¨ç†</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- å·¥ä½œæµç¨‹ -->
        <div class="summary">
            <h3>âš¡ å®é™…å·¥ä½œæµç¨‹</h3>
            <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                <ol style="font-size: 1.1em; line-height: 1.8;">
                    <li><strong>è¾“å…¥å¤„ç†ï¼š</strong>è¾“å…¥æ•°æ®è¿›å…¥Pipeline Stage 0</li>
                    <li><strong>Stage 0è®¡ç®—ï¼š</strong>GPU 0-7 è¿›è¡Œ8è·¯å¼ é‡å¹¶è¡Œè®¡ç®—å‰åŠéƒ¨åˆ†å±‚</li>
                    <li><strong>é˜¶æ®µé—´ä¼ é€’ï¼š</strong>æ¿€æ´»å€¼ä»Stage 0ä¼ é€’åˆ°Stage 1</li>
                    <li><strong>Stage 1è®¡ç®—ï¼š</strong>GPU 8-15 è¿›è¡Œ8è·¯å¼ é‡å¹¶è¡Œè®¡ç®—ååŠéƒ¨åˆ†å±‚</li>
                    <li><strong>è¾“å‡ºç”Ÿæˆï¼š</strong>æœ€ç»ˆç»“æœä»Stage 1è¾“å‡º</li>
                </ol>
            </div>

            <div style="background: #fff3cd; padding: 15px; border-radius: 10px; border-left: 4px solid #ffc107;">
                <strong>ğŸ’¡ ä¼˜åŠ¿ï¼š</strong>
                <ul>
                    <li>æ˜¾è‘—å‡å°‘å•GPUå†…å­˜å‹åŠ›ï¼ˆ16å€åˆ†æ‘Šï¼‰</li>
                    <li>æé«˜è®¡ç®—å¹¶è¡Œåº¦å’Œååé‡</li>
                    <li>æ”¯æŒæ›´å¤§è§„æ¨¡æ¨¡å‹çš„é«˜æ•ˆæ¨ç†</li>
                    <li>å¹³è¡¡äº†è®¡ç®—æ•ˆç‡å’Œé€šä¿¡å¼€é”€</li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>